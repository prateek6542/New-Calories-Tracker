<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .container {
            max-width: 800px;
            margin: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }

        th {
            background-color: #f4f4f4;
        }

        .total {
            font-weight: bold;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Dashboard</h1>

        <!-- Search Bar -->
        <form method="get">
            <input type="text" name="search" placeholder="Search for food items">
            <button type="submit">Search</button>
        </form>

        <!-- Food Items -->
        <h2>Food Items</h2>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Calories (per 100g)</th>
                    <th>Protein (g)</th>
                    <th>Carbs (g)</th>
                    <th>Fats (g)</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td>{{ item.name }}</td>
                    <td>{{ item.calories }}</td>
                    <td>{{ item.protein }}</td>
                    <td>{{ item.carbs }}</td>
                    <td>{{ item.fats }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Log a Meal -->
        <h2>Log a Meal</h2>
        <form method="post" action="{% url 'log_meal' %}">
            {% csrf_token %}
            <select name="food_item_id">
                {% for item in items %}
                <option value="{{ item.id }}">{{ item.name }}</option>
                {% endfor %}
            </select>
            <input type="number" name="quantity" placeholder="Quantity in grams" required>
            <button type="submit">Log Meal</button>
        </form>

        <!-- Today's Meals -->
        <h2>Today's Meals</h2>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Quantity (g)</th>
                    <th>Calories</th>
                    <th>Protein</th>
                    <th>Carbs</th>
                    <th>Fats</th>
                </tr>
            </thead>
            <tbody>
                {% for meal in today_meals %}
                <tr>
                    <td>{{ meal.food_item.name }}</td>
                    <td>{{ meal.quantity }}</td>
                    <td>{{ meal.total_calories }}</td>
                    <td>{{ meal.total_protein }}</td>
                    <td>{{ meal.total_carbs }}</td>
                    <td>{{ meal.total_fats }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Totals -->
        <div class="total">
            <p>Total Calories: {{ total_calories }}</p>
            <p>Total Protein: {{ total_protein }} g</p>
            <p>Total Carbs: {{ total_carbs }} g</p>
            <p>Total Fats: {{ total_fats }} g</p>
        </div>
    </div>
</body>
</html>
